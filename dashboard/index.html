<!DOCTYPE html>
<html lang="en" id="top">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>JMOD Dashboard</title>
  <meta name="color-scheme" content="dark light" />

  <style>
    :root {
      --bg: #0b0c10;
      --card: #13151b;
      --ink: #e8ebf4;
      --muted: #a2a8b6;
      --border: #222631;
      --accent: #4da3ff;
      --good: #17e5a1;
      --bad: #ff7b7b;
    }
    html, body {height:100%;margin:0;}
    html {scroll-behavior:smooth;}
    body {
      background: linear-gradient(180deg, #0b0c10, #0e1218);
      color: var(--ink);
      font: 14px/1.45 system-ui, Segoe UI, Inter, Arial, sans-serif;
    }

    /* NAVBAR */
    .nav {
      position: sticky; top: 0; z-index: 1000;
      background: #0d0f14cc;
      backdrop-filter: blur(8px);
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: flex-end;
      justify-content: space-between;
      padding: 10px 20px;
    }
    .nav-logo {
      height: 40px;
      width: auto;
    }
    .nav-links {
      display: flex; gap: 18px;
      align-items: flex-end;
    }
    .nav-links a {
      color: #f1f3f7; text-decoration: none; font-weight: 600;
    }
    .nav-links a:hover {opacity: .85;}

    /* TICKER */
    .ticker {
      white-space: nowrap;
      overflow: hidden;
      border-bottom: 1px solid var(--border);
      background: #0e1218;
    }
    .ticker-inner {
      display: inline-block;
      padding-block: 8px;
      animation: scroll 200s linear infinite;
    }
    @keyframes scroll {
      from {transform: translateX(0);}
      to {transform: translateX(-50%);}
    }
    .tick-item {
      display: inline-block;
      margin-right: 28px;
      color: #cfe0ff;
    }

    .wrap {max-width: 1200px; margin: 0 auto; padding: 0 14px 48px;}
    h1 {font-size: 22px; margin: 16px 0;}
    .grid {display: grid; gap: 16px;}
    @media (min-width: 900px){ .grid {grid-template-columns: 1fr 1fr;} }
    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    .card .hd {
      padding: 12px 14px;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .card .bd {padding: 14px;}
    .pill {
      font-size: 12px;
      background: #0f1420;
      border: 1px solid #1f2a43;
      color: #a9c8ff;
      padding: 5px 10px;
      border-radius: 999px;
    }

    /* Weather / Stocks */
    .symbols {display: grid; grid-template-columns: repeat(auto-fill, minmax(210px, 1fr)); gap: 10px;}
    .sym {
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 10px;
    }
    .sym .top {display: flex; justify-content: space-between;}
    .sym .price {font-size: 20px; font-weight: 800; margin-top: 4px;}
    .chg.up {color: var(--good);}
    .chg.down {color: var(--bad);}

    .mini {font-size: 12px; color: var(--muted);}
    .hrow {display: flex; gap: 10px; flex-wrap: wrap; margin-top: 8px;}
    .hchip {
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      border: 1px solid var(--border);
      background: #0f1218;
      border-radius: 10px;
      padding: 6px 8px; min-width: 52px;
    }
    .hchip .ico {font-size: 18px;}
    textarea {
      width: 100%; min-height: 120px;
      border: 1px solid var(--border);
      background: #0f1218;
      color: var(--ink);
      border-radius: 12px;
      padding: 10px;
    }

    .btm {display: flex; justify-content: center; margin: 28px 0;}
    .btn-top {
      background: #0f1420;
      border: 1px solid var(--border);
      color: #a9c8ff;
      padding: 8px 14px;
      border-radius: 999px;
      text-decoration: none;
      font-weight: 600;
    }
    .footer {color: #9aa3b6; text-align: center; padding-bottom: 24px;}
  </style>
</head>
<body>

  <!-- NAVBAR -->
  <div class="nav">
    <img src="/logo.png" alt="JMOD Co" class="nav-logo">
    <div class="nav-links">
      <a href="/">üè† Resume</a>
      <a href="#events">Local Events</a>
      <a href="#traffic">Traffic</a>
      <a href="#stocks">Stocks</a>
      <a href="#notes">Scratchpad</a>
    </div>
  </div>

  <!-- TICKER -->
  <div class="ticker"><div id="ticker" class="ticker-inner"></div></div>

  <div class="wrap">
    <h1>Welcome</h1>
    <div id="welcome" class="card">
      <div class="hd"><div>Welcome</div><span id="localDate" class="mini"></span></div>
      <div class="bd"></div>
    </div>

    <div class="card section" id="weather" style="margin-top:16px">
      <div class="hd"><div>Weather</div></div>
      <div class="bd"><div id="weatherList" class="symbols"></div></div>
    </div>

    <div class="card section" id="sun" style="margin-top:16px">
      <div class="hd"><div>Sunrise ‚Ä¢ Sunset</div><span id="sunDate" class="mini"></span></div>
      <div class="bd" id="sunBox"></div>
    </div>

    <div class="grid section" id="verse-events" style="margin-top:16px">
      <div class="card">
        <div class="hd"><div>Verse of the Day</div></div>
        <div class="bd" id="votd"></div>
      </div>
      <div class="card" id="events">
        <div class="hd"><div>Local Events</div></div>
        <div class="bd" id="eventsList"></div>
      </div>
    </div>

    <div class="grid section" id="traffic" style="margin-top:16px">
      <div class="card"><div class="hd"><div>To Work</div></div><iframe id="map1" title="route1"></iframe></div>
      <div class="card"><div class="hd"><div>To Home</div></div><iframe id="map2" title="route2"></iframe></div>
    </div>

    <div class="card section" id="stocks" style="margin-top:16px">
      <div class="hd"><div>Stocks</div><span class="pill">auto refresh</span></div>
      <div class="bd"><div id="stocksList" class="symbols"></div></div>
    </div>

    <div class="card section" id="notes" style="margin-top:16px">
      <div class="hd"><div>Scratchpad</div><button id="clearNotes" class="pill">Clear</button></div>
      <div class="bd"><textarea id="notesBox" placeholder="Jot quick notes‚Ä¶"></textarea></div>
    </div>

    <div class="btm"><a href="#top" class="btn-top">Top</a></div>
    <div class="footer">‚ú¶ Crafted by Jordan Moddes ¬∑ Built with GPT-5 Thinking ‚ú¶</div>
  </div>

  <!-- ================================ -->
  <!-- JS SECTION -->
  <!-- ================================ -->
  <script>
  const WORKER_BASE = "https://jmoddashboard.jmodwork.workers.dev";
  const GOOGLE_MAPS_API_KEY = "AIzaSyCePcq9W-S5yxscXJ2N2MBMoGtpeTAXZnQ";
  const HOME = "2670 S AW Grimes Blvd, Round Rock, TX 78664";
  const WORK = "411 W Main St, Round Rock, TX 78664";
  const WEATHER_ZIPS = ["78664","53158","60030","44115"];
  const STOCKS = ["AAPL","NVDA","AMZN","TSLA","BRK.B"];
  const CRYPTO = ["bitcoin","ethereum","dogecoin"];

  const $ = s => document.querySelector(s);
  const enc = s => encodeURIComponent(s).replace(/%20/g,'+');
  const toF = c => (c*9/5)+32;
  const iconFor = c=>({0:"‚òÄÔ∏è",1:"üå§Ô∏è",2:"‚õÖ",3:"‚òÅÔ∏è",61:"üåßÔ∏è",63:"üåßÔ∏è",80:"üå¶Ô∏è",81:"üå¶Ô∏è",82:"üåßÔ∏è",95:"‚õàÔ∏è"}[c]||"üå°Ô∏è");

  const ZIP_COORDS = {
    "78664": { lat: 30.5083, lon: -97.6789, name: "Round Rock, TX" },
    "53158": { lat: 42.5531, lon: -87.9501, name: "Pleasant Prairie, WI" },
    "60030": { lat: 42.3445, lon: -88.0417, name: "Grayslake, IL" },
    "44115": { lat: 41.4993, lon: -81.6944, name: "Cleveland, OH" }
  };

  (function setGreeting(){
    const now = new Date();
    const hrs = now.getHours();
    const mm = String(now.getMonth()+1).padStart(2,"0"), dd = String(now.getDate()).padStart(2,"0"), yyyy = now.getFullYear();
    $("#localDate").textContent = `${mm}/${dd}/${yyyy}`;
    let msg = hrs<12?"Good morning ‚òï":"Good evening üåá";
    $("#welcome .bd").innerHTML = `<div>${msg}</div><div class="mini muted" style="margin-top:6px">Welcome to my private dashboard. I‚Äôm testing, learning, and having fun. Explore freely.</div>`;
  })();

  async function loadTicker(){
    try{
      const r = await fetch(`${WORKER_BASE}/ticker?sources=nfl,f1,general`);
      const j = await r.json();
      $("#ticker").innerHTML = j.concat(j).map(x=>`<span class='tick-item'>‚Ä¢ ${x.title}</span>`).join("");
    }catch{ $("#ticker").textContent="Ticker unavailable"; }
  }

  const mapsURL = (o,d)=>`https://www.google.com/maps/embed/v1/directions?key=${GOOGLE_MAPS_API_KEY}&origin=${enc(o)}&destination=${enc(d)}&mode=driving`;
  function loadTraffic(){ $("#map1").src=mapsURL(HOME,WORK); $("#map2").src=mapsURL(WORK,HOME); }

  async function fetchWeather(lat,lon){
    const r = await fetch(`${WORKER_BASE}/wx?lat=${lat}&lon=${lon}`);
    return r.json();
  }

  async function loadWeather(){
    const host=$("#weatherList");host.innerHTML="";
    const seen=new Set();
    for(const zip of WEATHER_ZIPS){
      if(seen.has(zip))continue;seen.add(zip);
      try{
        const g=ZIP_COORDS[zip];
        const d=await fetchWeather(g.lat,g.lon);
        const c=d.current, minC=d.daily.temperature_2m_min[0], maxC=d.daily.temperature_2m_max[0];
        const t=d.hourly.time.map(t=>new Date(t));
        let i=t.findIndex(x=>x>=new Date()); if(i<0)i=0;
        const hrs=Array.from({length:5},(_,k)=>i+k).map(x=>({h:String(t[x].getHours()).padStart(2,"0"),v:d.hourly.temperature_2m[x],c:d.hourly.weather_code[x]}));
        const card=document.createElement("div");card.className="sym";
        card.innerHTML=`<div class='top'><div><strong>${g.name}</strong> ${iconFor(c.weather_code)}</div><div class='mini'>${Math.round(c.wind_speed_10m)} mph wind</div></div>
        <div class='price'>${Math.round(toF(c.temperature_2m))}¬∞F / ${Math.round(c.temperature_2m)}¬∞C</div>
        <div class='mini muted'>Feels ${Math.round(toF(c.apparent_temperature))}¬∞F ¬∑ Today ${Math.round(toF(minC))}¬∞‚Äì${Math.round(toF(maxC))}¬∞F</div>
        <div class='hrow'>${hrs.map(h=>`<div class='hchip'><div class='ico'>${iconFor(h.c)}</div><div class='t mini'>${Math.round(toF(h.v))}¬∞F</div><div class='mini muted'>${h.h}:00</div></div>`).join("")}</div>`;
        host.appendChild(card);
      }catch{
        const card=document.createElement("div");card.className="sym";card.innerHTML=`<div class='top'><strong>${zip}</strong></div><div class='mini muted'>Weather unavailable</div>`;
        host.appendChild(card);
      }
    }
  }

  async function loadSun(){
    const {lat,lon}=ZIP_COORDS["78664"];
    try{
      const r=await fetch(`https://api.sunrise-sunset.org/json?lat=${lat}&lng=${lon}&formatted=0`);
      const j=await r.json();const s=new Date(j.results.sunrise),t=new Date(j.results.sunset);
      const f=x=>x.toLocaleTimeString([], {hour:"numeric",minute:"2-digit"});
      $("#sunBox").textContent=`Sunrise ${f(s)} ‚Ä¢ Sunset ${f(t)}`;
    }catch{ $("#sunBox").textContent="Sunrise/Sunset unavailable"; }
  }

  async function loadVOTD(){
    try{
      const r=await fetch("https://beta.ourmanna.com/api/v1/get/?format=json");
      const j=await r.json();
      const v=j.verse?.details||j.verse?.verse?.details;
      if(v){$("#votd").innerHTML=`<div>${v.text}</div><div class='mini muted' style='margin-top:6px'>${v.reference}</div>`;}
    }catch{$("#votd").textContent="Verse unavailable";}
  }

  async function loadEvents(){
    const {lat,lon}=ZIP_COORDS["78664"];
    try{
      const r=await fetch(`${WORKER_BASE}/events?lat=${lat}&lon=${lon}&radius=50&size=6`);
      const j=await r.json();
      if(Array.isArray(j)&&j.length){
        $("#eventsList").innerHTML=j.map(e=>`<div class='sym'><div class='top'><strong>${e.name}</strong></div><div class='mini muted'>${e.city||""}</div><div class='mini'>${new Date(e.date).toLocaleDateString()}</div><a href='${e.url}' class='mini' target='_blank'>Details</a></div>`).join("");
      }else{$("#eventsList").innerHTML="<div class='mini muted'>Add TM_KEY to Worker for local events.</div>";}
    }catch{$("#eventsList").innerHTML="<div class='mini muted'>Events unavailable</div>";}
  }

  async function loadStocks(){
    const host=$("#stocksList");host.innerHTML="";
    try{
      const r=await fetch(`${WORKER_BASE}/quotes?symbols=${encodeURIComponent(STOCKS.join(','))}`);
      const rows=await r.json();
      rows.forEach(q=>{
        const c=q.changePercent,d=document.createElement("div");d.className="sym";
        d.innerHTML=`<div class='top'><strong>${q.symbol}</strong><div class='mini chg ${c>=0?"up":"down"}'>${c>=0?"+":""}${c.toFixed(2)}%</div></div><div class='price'>$${q.price.toFixed(2)}</div>`;
        host.appendChild(d);
      });
    }catch{host.innerHTML="<div class='mini muted'>Stocks unavailable</div>";}
  }

  const notesEl=$("#notesBox");
  notesEl.value=localStorage.getItem("dashboard-notes")||"";
  notesEl.addEventListener("input",()=>localStorage.setItem("dashboard-notes",notesEl.value));
  $("#clearNotes").onclick=()=>{notesEl.value="";local
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#000000" />
  <title>YES</title>

  <style>
    :root{
      --bg:#000;
      --lime:#32cd32; /* lime green */
      --white:#fff;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:var(--bg);
      color:var(--white);
      overflow:hidden;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }

    /* Layers */
    .stage{
      position:fixed;
      inset:0;
      overflow:hidden;
      background:#000;
    }

    /* Chaos layer: all the flying "yes" */
    #chaos{
      position:absolute;
      inset:0;
      display:block;
      background:#000;
      opacity:1;
      pointer-events:none;
    }

    /* Center anchor: all chaos spans are positioned relative to center */
    #swarm{
      position:absolute;
      left:50%;
      top:50%;
      width:0;
      height:0;
      pointer-events:none;
    }

    .y{
      position:absolute;
      left:0;
      top:0;
      transform-origin:center;
      will-change: transform, opacity, filter;
      user-select:none;
      white-space:nowrap;
      letter-spacing:-0.01em;
      mix-blend-mode:screen;
      text-shadow: 0 6px 18px rgba(0,0,0,.25);
    }

    /* Final screen */
    #finalWrap{
      position:absolute;
      inset:0;
      display:grid;
      place-items:center;
      background:var(--lime);
      opacity:0;
      pointer-events:none;
      will-change: opacity, filter, transform;
    }

    #finalText{
      color:var(--white);
      font-weight:900;
      letter-spacing:-0.06em;
      line-height:0.9;
      font-size:clamp(72px, 18vw, 260px);
      text-transform:uppercase;
      text-shadow: 0 16px 40px rgba(0,0,0,.22);
      will-change: transform, opacity;
    }

    /* Impact flash */
    #flash{
      position:absolute;
      inset:0;
      background:#fff;
      opacity:0;
      pointer-events:none;
    }

    /* Subtle vignette */
    .vignette{
      position:absolute;
      inset:-20%;
      pointer-events:none;
      background:radial-gradient(ellipse at center, rgba(0,0,0,0) 55%, rgba(0,0,0,.35) 100%);
      mix-blend-mode:multiply;
      opacity:.65;
    }

    /* Dissolve effect via SVG filter */
    .dissolve{
      filter:url(#dissolveFilter);
    }

    /* Optional micro shake on impact */
    @keyframes thump {
      0%{ transform:translate3d(0,0,0) }
      20%{ transform:translate3d(-6px,2px,0) }
      40%{ transform:translate3d(5px,-3px,0) }
      60%{ transform:translate3d(-3px,3px,0) }
      80%{ transform:translate3d(2px,-2px,0) }
      100%{ transform:translate3d(0,0,0) }
    }
    .thump{ animation:thump 180ms linear 1; }

    /* Reduced motion: no flying, just instant YES */
    @media (prefers-reduced-motion: reduce){
      #chaos{display:none}
      #finalWrap{opacity:1}
      #flash{display:none}
    }
  </style>
</head>

<body>
  <div class="stage" id="stage">
    <div id="chaos">
      <div id="swarm" aria-hidden="true"></div>
      <div id="flash" aria-hidden="true"></div>
      <div class="vignette" aria-hidden="true"></div>
    </div>

    <div id="finalWrap" aria-hidden="true">
      <div id="finalText">YES</div>
      <div class="vignette" aria-hidden="true" style="opacity:.22"></div>
    </div>

    <!-- SVG filter used for dissolve -->
    <svg width="0" height="0" style="position:absolute">
      <filter id="dissolveFilter">
        <feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="2" seed="9" result="noise">
          <!-- animated in JS by updating baseFrequency -->
        </feTurbulence>
        <feDisplacementMap in="SourceGraphic" in2="noise" scale="28" xChannelSelector="R" yChannelSelector="G"/>
      </filter>
    </svg>
  </div>

  <script>
    (() => {
      // ====== TUNABLES ======
      const COUNT = 110;          // ~100 yes words (intentionally overkill)
      const CHAOS_MS = 6000;      // flying phase
      const CONVERGE_MS = 2000;   // merge into center
      const HOLD_MS = 20000;      // lime YES hold
      const DISSOLVE_MS = 4000;   // dissolve to black
      const LOOP_GAP_MS = 120;    // tiny pause before restart

      const NEON = [
        "#ff005d","#00f5ff","#ffe600","#baff00","#ff7a00",
        "#b400ff","#00ff85","#ff3df2","#3dfffc","#ff2a2a",
        "#00aaff","#ffcc00","#7cff00","#ff00aa","#00fffb"
      ];

      const swarm = document.getElementById("swarm");
      const chaosLayer = document.getElementById("chaos");
      const finalWrap = document.getElementById("finalWrap");
      const finalText = document.getElementById("finalText");
      const flash = document.getElementById("flash");
      const stage = document.getElementById("stage");
      const turb = document.querySelector("#dissolveFilter feTurbulence");

      let running = false;
      let timers = [];
      let anims = [];

      const rand = (a,b) => a + Math.random()*(b-a);
      const pick = arr => arr[Math.floor(Math.random()*arr.length)];
      const clamp = (v,min,max) => Math.max(min, Math.min(max,v));

      function clearAll(){
        timers.forEach(t => clearTimeout(t));
        timers = [];
        anims.forEach(a => { try{ a.cancel(); }catch(e){} });
        anims = [];
        swarm.innerHTML = "";
        flash.style.opacity = 0;
        chaosLayer.style.opacity = 1;
        finalWrap.style.opacity = 0;
        finalWrap.classList.remove("dissolve");
        stage.classList.remove("thump");
        turb && turb.setAttribute("baseFrequency", "0.9");
      }

      function makeOne(i){
        const el = document.createElement("span");
        el.className = "y";

        // One wrong "yes" (tiny easter egg)
        const wrong = (i === Math.floor(COUNT*0.18));
        el.textContent = wrong ? (Math.random() < 0.5 ? "yess" : "y e s") : "yes";

        // Styling randomness
        const size = rand(12, 64); // px
        const weight = Math.random() < 0.25 ? 800 : (Math.random() < 0.6 ? 700 : 600);
        el.style.fontSize = size.toFixed(1) + "px";
        el.style.fontWeight = weight;
        el.style.color = pick(NEON);

        // Initial transform: start offscreen-ish relative to center
        const vw = window.innerWidth;
        const vh = window.innerHeight;

        // pick a side
        const side = Math.floor(rand(0,4));
        let sx, sy;
        const pad = Math.max(vw, vh) * 0.75;

        if(side === 0){ // left
          sx = -pad;
          sy = rand(-vh*0.6, vh*0.6);
        } else if(side === 1){ // right
          sx = pad;
          sy = rand(-vh*0.6, vh*0.6);
        } else if(side === 2){ // top
          sx = rand(-vw*0.6, vw*0.6);
          sy = -pad;
        } else { // bottom
          sx = rand(-vw*0.6, vw*0.6);
          sy = pad;
        }

        // End position: messy near center
        const ex = rand(-Math.min(260, vw*0.22), Math.min(260, vw*0.22));
        const ey = rand(-Math.min(180, vh*0.18), Math.min(180, vh*0.18));

        const r0 = rand(-180, 180);
        const r1 = r0 + rand(-35, 35);

        // Apply start state
        el.style.opacity = 0.98;
        el.style.transform = `translate3d(${sx}px, ${sy}px, 0) rotate(${r0}deg) scale(${rand(0.85,1.35)})`;

        swarm.appendChild(el);

        // Fly-in animation (chaos phase)
        const d = rand(1100, 2600);
        const delay = rand(0, CHAOS_MS - 1200);
        const fly = el.animate(
          [
            { transform: `translate3d(${sx}px, ${sy}px, 0) rotate(${r0}deg) scale(${rand(0.85,1.35)})`, opacity: 0.95 },
            { transform: `translate3d(${ex}px, ${ey}px, 0) rotate(${r1}deg) scale(${rand(0.95,1.6)})`, opacity: 1 }
          ],
          {
            duration: d,
            delay,
            easing: "cubic-bezier(.16,.85,.22,1)",
            fill: "forwards"
          }
        );
        anims.push(fly);

        // Save end point for converge
        el.dataset.ex = ex;
        el.dataset.ey = ey;
        el.dataset.r = r1;

        return el;
      }

      function flashImpact(){
        // 1â€“2 frames too long by design
        flash.animate(
          [{opacity:0},{opacity:0.95},{opacity:0}],
          {duration:220, easing:"linear", fill:"forwards"}
        );
      }

      function convergeAll(){
        const kids = [...swarm.children];

        // micro shake (thump)
        stage.classList.add("thump");
        timers.push(setTimeout(() => stage.classList.remove("thump"), 220));

        flashImpact();

        // Converge into center
        kids.forEach((el, idx) => {
          const ex = parseFloat(el.dataset.ex || "0");
          const ey = parseFloat(el.dataset.ey || "0");
          const r = parseFloat(el.dataset.r || "0");

          // One straggler arrives late
          const isStraggler = (idx === Math.floor(COUNT*0.72));
          const extraDelay = isStraggler ? 520 : rand(0, 140);

          // 2-3 "bounce/overshoot" gags
          const isBouncer = (idx % 47 === 0);

          const keyframes = isBouncer
            ? [
                { transform: `translate3d(${ex}px, ${ey}px, 0) rotate(${r}deg) scale(1)`, opacity:1 },
                { transform: `translate3d(${ex*0.15}px, ${ey*0.15}px, 0) rotate(${r*0.3}deg) scale(1.1)`, opacity:1, offset:0.55 },
                { transform: `translate3d(${rand(-18,18)}px, ${rand(-18,18)}px, 0) rotate(${rand(-8,8)}deg) scale(1.28)`, opacity:1, offset:0.82 },
                { transform: `translate3d(0px, 0px, 0) rotate(0deg) scale(1.65)`, opacity:0, offset:1 }
              ]
            : [
                { transform: `translate3d(${ex}px, ${ey}px, 0) rotate(${r}deg) scale(1)`, opacity:1 },
                { transform: `translate3d(0px, 0px, 0) rotate(0deg) scale(1.9)`, opacity:0 }
              ];

          const a = el.animate(keyframes, {
            duration: CONVERGE_MS,
            delay: extraDelay,
            easing: "cubic-bezier(.2,.9,.2,1)",
            fill: "forwards"
          });

          anims.push(a);
        });

        // Reveal final screen quickly after converge begins
        const t = Math.max(240, CONVERGE_MS * 0.45);
        timers.push(setTimeout(() => {
          finalWrap.style.opacity = 1;

          // Sub-pixel drift on the final YES (barely visible)
          finalText.animate(
            [
              { transform: "translate3d(0px,0px,0)" },
              { transform: "translate3d(1px,-1px,0)" },
              { transform: "translate3d(-1px,1px,0)" },
              { transform: "translate3d(0px,0px,0)" }
            ],
            { duration: HOLD_MS, easing:"linear", fill:"forwards" }
          );

          // Fade chaos out under it
          chaosLayer.animate(
            [{opacity:1},{opacity:0}],
            {duration: 500, easing:"ease-out", fill:"forwards"}
          );
        }, t));
      }

      function dissolveToBlack(){
        // Apply dissolve filter + fade out
        finalWrap.classList.add("dissolve");

        // Animate turbulence frequency to "crawl" the dissolve
        const start = performance.now();
        const tick = () => {
          const p = clamp((performance.now() - start) / DISSOLVE_MS, 0, 1);
          // frequency rises then falls a bit: more chaotic mid dissolve
          const freq = 0.6 + Math.sin(p * Math.PI) * 1.15;
          turb && turb.setAttribute("baseFrequency", freq.toFixed(3));
          if(p < 1) requestAnimationFrame(tick);
        };
        requestAnimationFrame(tick);

        finalWrap.animate(
          [
            { opacity: 1, filter: "url(#dissolveFilter)" },
            { opacity: 0, filter: "url(#dissolveFilter)" }
          ],
          { duration: DISSOLVE_MS, easing:"ease-in", fill:"forwards" }
        );
      }

      function runLoop(){
        if (running) return;
        running = true;

        const reduce = window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches;
        if(reduce){
          finalWrap.style.opacity = 1;
          return;
        }

        clearAll();

        // Build swarm
        for(let i=0;i<COUNT;i++) makeOne(i);

        // Converge into YES
        timers.push(setTimeout(convergeAll, CHAOS_MS));

        // Hold, then dissolve
        timers.push(setTimeout(() => {
          dissolveToBlack();
        }, CHAOS_MS + CONVERGE_MS + HOLD_MS));

        // Reset and restart
        timers.push(setTimeout(() => {
          running = false;

          // Optional 1-frame "NO" at impact? (disabled by default)
          // If you want it, uncomment:
          // const noFlash = document.createElement("div");
          // noFlash.style.cssText="position:absolute;inset:0;display:grid;place-items:center;background:#000;color:#fff;font-weight:900;font-size:clamp(60px,16vw,220px);letter-spacing:-.06em";
          // noFlash.textContent="NO";
          // stage.appendChild(noFlash);
          // requestAnimationFrame(()=>requestAnimationFrame(()=>noFlash.remove()));

          setTimeout(runLoop, LOOP_GAP_MS);
        }, CHAOS_MS + CONVERGE_MS + HOLD_MS + DISSOLVE_MS + LOOP_GAP_MS));
      }

      // Restart on resize (keeps directions sane)
      let resizeT;
      window.addEventListener("resize", () => {
        clearTimeout(resizeT);
        resizeT = setTimeout(() => {
          running = false;
          runLoop();
        }, 120);
      });

      document.addEventListener("visibilitychange", () => {
        if(document.hidden){
          running = false;
          clearAll();
        } else {
          runLoop();
        }
      });

      runLoop();
    })();
  </script>
</body>
</html>